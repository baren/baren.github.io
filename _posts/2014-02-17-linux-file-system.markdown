---
comments: true
date: 2014-02-10 19:33:00
layout: post
title: linxu 文件系统笔记
summary: 'linux file sys'
tags:
- linux
- 笔记
---
[14-1]: /assets/Figure14-1.png "layout of disk partitions and a file system"


# 设备特殊文件

设备可以划分成两种类型：

* 字符设备。一个字符一个字符的处理数据，终端和键盘就是例子。
* 块设备。一次处理一块数据。块大小依赖于设备类型。一般都是512字节的倍数。磁盘就是这种设备。

## 设备ID
每一个设备文件都有一个主ID号和副ID号。主ID号标记设备的一般类型，内核使用这个主ID来寻找这种类型设备对应的驱动。副ID号唯一的标记这个设备类型下得特殊设备了。ls -l可以显示主ID和副ID

# 磁盘和分区

* 一个磁盘可以分成多个分区。
* 信息都放在磁盘的磁道上，磁道被划分成扇区，每一个扇区都由一系列的物理块组成。物理块的大小一般时512或者其倍数个字节，代表了最小的信息单元。

## 分区

一个分区可以包含以下信息：

* 文件系统，也即每个分区可以包含一个文件系统
* 数据区域
* swap区域

# 文件系统

linux支持广泛的文件系统，包括
* 传统的ext2文件系统
* 原生的unix文件系统，包括 Minix, System V和 BSD文件系统
* 微软的FAT, FAT32, 和 NTFS
* apple的HFS
* 网络文件系统，包括sun的NFS等
* 一系列日志文件系统，包括xt3, ext4, Reiserfs, JFS, XFS, 和 Btrfs


以ext2文件系统为例，介绍文件系统，ext2文件系统源代码很小，大约5000行c程序（http://e2fsprogs.sourceforge.net/ext2.html.）

## 文件系统结构

磁盘分成多个逻辑分区，每一个分区可拥有一个文件系统，比如：
![alt text][14-1]

* boot块，总是文件系统的第一个块，文件系统不会使用这个块，boot块是用来重启操作系统的。虽然每个分区的文件系统都有一个boot块，但只有一个会被使用。
* superblock，紧随boot块后的一个单一块，包含如下信息
>* i-nod表的大小
>* 此文件系统的逻辑块大小
>* 文件系统的大小

* inode表。文件系统的每一个文件或者目录都在inode表中对应一个唯一的表项。这个表项记录了文件的各种信息。
* 数据块，磁盘的最主要的文件数据存储区域。

## i-node

对于所有的文件系统内的文件，文件系统的i-node表都有一个唯一的i-node表项与之对应。i-node使用i-node在表中的顺序号来引用（数组实现？）。
*i-node number*是ls -li命令的第一个字段.

i-node包含的信息有：

* 




















